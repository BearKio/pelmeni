"use strict";function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}window.onload=function(){new Vue({el:"#main",data:{heightPromoSection:0,categoriesMenu:[],sectionMenu:[],productsBlocks:[],currentProductsBlock:[],sectionMenuTitle:"Наше меню",numberInCart:0,currentOrder:[],listProduct:[],amountOrder:0,catalogItems:[],name:"",phone:"",address:"",message:"",sumOrder:"",errors:!1,nameError:!1,phoneError:!1,addressError:!1,orderError:!1,check1:!0,check2:!1},methods:{getHeightPromoSection:function(){var e=document.querySelector(".promo");this.heightPromoSection=e.clientHeight},fixedHeader:function(){var e=document.querySelector(".header");window.pageYOffset>this.heightPromoSection-200?e.classList.add("header--fixed"):e.classList.contains("header--fixed")&&e.classList.remove("header--fixed")},initEventsClick:function(e,t){var r=this;1<e.length?e.forEach(function(e){e.addEventListener("click",function(e){e.preventDefault(),document.querySelector("body").classList.contains("menu-active")&&document.querySelector("body").classList.remove("menu-active"),r.scrollInSection(t)})}):e[0].addEventListener("click",function(e){e.preventDefault(),document.querySelector("body").classList.contains("menu-active")&&document.querySelector("body").classList.remove("menu-active"),r.scrollInSection(t)})},initEventsScroll:function(){var e=document.querySelectorAll(".link-about"),t=document.querySelector(".why");this.initEventsClick(e,t);var r=document.querySelectorAll(".link-menu"),i=document.querySelector(".menu");this.initEventsClick(r,i);var n=document.querySelectorAll(".link-delivery"),o=document.querySelector(".delivery");this.initEventsClick(n,o);var s=document.querySelectorAll(".link-contacts"),c=document.querySelector(".footer");this.initEventsClick(s,c);var a=document.querySelectorAll(".link-order"),l=document.querySelector(".order");this.initEventsClick(a,l)},getCoords:function(e){return e.getBoundingClientRect().top+pageYOffset},scrollInSection:function(e){var t=this.getCoords(e);window.scrollTo({top:t-100,behavior:"smooth"})},toggleAdaptiveMenu:function(){document.querySelector("body").classList.toggle("menu-active")},openProducts:function(e){var t=e.target.textContent,r=e.target.parentElement;r.hasAttribute("data-id")||(r=r.parentElement);var i=r.getAttribute("data-id");this.currentProductsBlock=this.productsBlocks.filter(function(e){if(e.getAttribute("data-id")===i)return e}),this.currentProductsBlock.length&&(this.sectionMenuTitle=t,this.categoriesMenu.style.display="none",this.currentProductsBlock[0].style.height="auto",window.innerWidth<1615&&this.currentProductsBlock[0].classList.add("catalog-block--active"),this.sectionMenu.classList.add("menu--active"),this.scrollInSection(this.sectionMenu))},closeProductsBlock:function(){this.sectionMenuTitle="Наше меню",this.categoriesMenu.style.display="flex",this.currentProductsBlock[0].style.height="0",this.currentProductsBlock[0].classList.contains("catalog-block--active")&&this.currentProductsBlock[0].classList.remove("catalog-block--active"),this.sectionMenu.classList.remove("menu--active")},addProductToCart:function(e){this.numberInCart++;var t=this.getCatalogItem(e.target),r=t.getAttribute("data-id"),i=this.currentOrder.find(function(e){return e.id===r});if(void 0!==i)t.classList.add("catalog-item--add"),i.number++,i.price=this.checkPrice(r,i.number);else{t.classList.add("catalog-item--add");var n=t.querySelector("h6").textContent,o=t.querySelector(".catalog-item__price").textContent;o=Number(o.split(" ")[0]);var s={id:r,title:n,price:o,number:1};this.currentOrder.push(s);var c=JSON.parse(JSON.stringify(s));this.listProduct.push(c),this.catalogItems.forEach(function(e){e.getAttribute("data-id")===r&&e.classList.add("catalog-item--add")})}this.ordering()},getCatalogItem:function(e){return e.hasAttribute("data-id")?e:(e=e.parentElement,this.getCatalogItem(e))},ordering:function(){this.amountOrder=this.currentOrder.reduce(function(e,t){return e+t.price},0)},increaseNumberProductInOrder:function(t){var e=this.currentOrder.find(function(e){return e.id===t});e.number++,this.numberInCart++,e.price=this.checkPrice(t,e.number),this.ordering()},reduceNumberProductInOrder:function(t){var r=this.currentOrder.find(function(e){return e.id===t});r.number--,this.numberInCart--,r.price=this.checkPrice(t,r.number),0===r.number&&(this.catalogItems.forEach(function(e){e.getAttribute("data-id")===r.id&&e.classList.remove("catalog-item--add")}),this.currentOrder=this.currentOrder.filter(function(e){return e.id!==t})),this.ordering()},checkPrice:function(t,e){return this.listProduct.find(function(e){return e.id===t}).price*e},submitForm:function(e){var t=this.searchForm(e.target);if(t.className="form",this.nameError=!1,this.phoneError=!1,this.addressError=!1,this.orderError=!1,this.errors=!1,this.currentOrder.length||(this.orderError=!0,this.errors=!0),""===this.name&&(this.nameError=!0,this.errors=!0,t.classList.add("form--error_name")),""===this.address&&(this.addressError=!0,this.errors=!0,t.classList.add("form--error_address")),""===this.phone&&(this.phoneError=!0,this.errors=!0,t.classList.add("form--error_phone")),!this.errors){this.currentOrder.forEach(function(e){delete e.id});var r=this.currentOrder.map(function(e){return"Наименование: ".concat(e.title," - Стоимость: ").concat(e.price," рублей - Кол-во: ").concat(e.number," шт.")});console.log(r),this.message=JSON.stringify(this.currentOrder),this.sumOrder=String(this.amountOrder);var i=new FormData(t);i.append("message",JSON.stringify(this.currentOrder)),i.append("sum",String(this.amountOrder)),this.check1?i.append("payment","Наличными"):i.append("payment","Переводом на банковскую карту"),fetch("/send.php",{method:"POST",body:i}).then(function(e){console.log(e),e.ok?location.assign("/thanks.html"):console.log("Заказ не отправился!")})}},searchForm:function(e){return e.hasAttribute("action")?e:(e=e.parentElement,this.searchForm(e))},checkCheckbox:function(){this.check1=!this.check1,this.check2=!this.check2}},mounted:function(){var e=this;this.initEventsScroll(),this.getHeightPromoSection(),window.addEventListener("resize",function(){e.getHeightPromoSection()}),window.addEventListener("scroll",this.fixedHeader),this.categoriesMenu=document.querySelector(".menu-block"),this.sectionMenu=document.querySelector(".menu"),this.productsBlocks=this.sectionMenu.querySelectorAll(".catalog-block"),this.productsBlocks=_toConsumableArray(this.productsBlocks),this.catalogItems=document.querySelectorAll(".catalog-item")}});try{var e=document.querySelector(".best-slider"),t=function(e,t){if(e){var r=t.parentElement,i=r.querySelector(".arrow-next"),n=r.querySelector(".arrow-prev");$(t).slick({dots:!0,infinite:!1,arrows:!0,nextArrow:$(i),prevArrow:$(n),speed:300,slidesToShow:3,slidesToScroll:1,responsive:[{breakpoint:1200,settings:{slidesToShow:2}},{breakpoint:800,settings:{slidesToShow:1}}]})}else $(t).slick("unslick")};window.innerWidth<1615&&e&&t(!0,e),window.addEventListener("resize",function(){window.innerWidth<1615?e.classList.contains("slick-initialized")||e&&t(!0,e):e.classList.contains("slick-initialized")&&e&&t(!1,e)})}catch(e){console.log(e+"best slider")}try{var r=document.querySelectorAll(".product-slider"),i=function(e,t){if(e){var r=t.parentElement,i=r.querySelector(".arrow-next"),n=r.querySelector(".arrow-prev");$(t).slick({dots:!0,infinite:!1,arrows:!0,nextArrow:$(i),prevArrow:$(n),speed:300,slidesToShow:4,slidesToScroll:1,responsive:[{breakpoint:1615,settings:{slidesToShow:3}},{breakpoint:1200,settings:{slidesToShow:2}},{breakpoint:800,settings:{slidesToShow:1}}]})}else $(t).slick("unslick")};window.innerWidth<1615&&r&&r.forEach(function(e){i(!0,e)}),window.addEventListener("resize",function(){window.innerWidth<1615?r.forEach(function(e){e.classList.contains("slick-initialized")||i(!0,e)}):r.forEach(function(e){e.classList.contains("slick-initialized")&&i(!1,e)})})}catch(e){console.log(e+"products sliders")}};